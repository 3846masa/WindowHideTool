# WindowHideTool

Version 2.1

公開日:2013/08/21

## 概要

- ウィンドウを隠すソフトウェアです。
- webカメラの映像の変化量を監視しています。
- webカメラがなくても、体験できます。
- このソフトは「HGP教科書体」「HGP平成角ｺﾞｼｯｸ体W9」のフォントを利用しています。
  - インストールされていないと、レイアウトが崩れることがあります。
  - これらのフォントはMicrosoft Officeに付属しています。

## 中身

- tool
  - 後述
- sound
  - 音データが入っています。
- voice
  - 音声データが入っています。
- Recovery.hsp
  - ウィンドウを復元します。
  - ソフトが異常終了した時に使います。
- WindowHideTool.hsp
  - 本体です。
- README.md
  - 取扱説明書です。

## 使い方

**BGMは自分で用意してください(後述)**

1. WindowHideTool.exeを起動します。
  - 起動選択画面が出ます。
    - Booting Software
      - 通常起動します。
    - Testing EVA mode
      - エヴァモードを直接起動します。
      - カメラ監視は行いません。
      - webカメラがない方は、こちらを選択してください。

2. カメラデバイスを選択します。

3. カメラ設定画面で調整します。
  - Setting CAM
    - カメラの設定画面が出ます。
    - 反応が悪い時はゲインを上げると多少改善されます。
  - Normal mode
    - 検知後、即座にウィンドウが消えます。
  - EVA mode
    - 検知後、エヴァ風の画面でウィンドウを格納します。

  - タイトル(デバック用)
    - 詳細が表示されています。
    - (画像一致率)::(映像解像度)::(判定)::(変化率)
    - 変化率が0.01以上で検出と認識します。
    - 画像一致率が"0.000000"の時は映像の明るさを調節してください。

4. 起動後
  - 監視中は見た目ではわかりません。

5. 検出後
  - ウィンドウが消えます。
  - ESCキーを長押しすると元に戻ります。
  - EVAmodeの場合は、元に戻したあとAlt+F4で終了します。

## 人の検知方法

- 色の変化を見ています。
- 詳しくは[HSP開発wiki:二つの画像を比較し総似率を返す](http://wiki.hsp.moe/As.html)を参照してください。

## BGMについて

本番では **「2EM33_0902"The Final Decision We All Must Take"」** を使いました。
**Evangelion2.0オリジナル・サウンドトラックCD1-トラック29** です。

toolフォルダに ``WAV.bat`` が入っています。

BGMにしたいファイル（動画・音声）を ``WAV.bat`` にD&Dします。
できたファイル（bgm.wav）を **soundフォルダ** に入れてください。

**（音源がwave方式の場合は、 ``bgm.wav`` にリネームしてsoundフォルダに入れてください。）**

## 注意事項

- 起動は自己責任でお願いします。
- 万が一、PCの調子が悪くなった場合は、再起動をしてみてください。

## 使用物

### [ds_play.dll:DirectSound再生プラグイン for HSP](http://www.binzume.net/)
(c) K-K(川平 航介)

> 著作権はＫ－Ｋにあります．
> また，このプログラムによって生じた，いかなる損害についても保証しません．
> 自己の責任の範囲で使用してください．
> 使用に関しては特に制限はありません．
> 商用・非商用に限らず，自由に使ってください．
> 転載や雑誌掲載を希望される場合も基本的に連絡の必要はありません．
> 転載の場合，可能なら常に最新版を置くようにしてください．

### [hscallbk.dll:コールバック関数実装プラグイン for HSP3](http://chokuto.ifdef.jp/)
(c) ちょくと
> このアーカイブに含まれる拡張プラグインやプログラムやドキュメントは作者である ちょくと がその著作権を保有しています。
> この拡張プラグインはフリーウェアです。商用・非商用を問わず、自由に使用することができます。
> このソフトウェアを使用することによって生じた、いかなる損害についても、作者は一切関与せず、責任を追わないものとさせていただきます。
> このソフトウェアを使用する場合は、各使用者の責任の元で行ってください。
> これに応じられない場合には、このソフトウェアを使用しないでください。

### [KeyHook.dll:キーフック実装DLL](http://tu3.jp/)
(c) つーさ

> 公序良俗に反しない限り自由に使用可。
> DLL作者はそれが組み込まれる成果物に対して一切の責任を負わない。
> DLL作者は本DLLが発生させるいかなる損害についても責任を負わない。

### [hspdsc.dll:DirectShowベースキャプチャデバイスプラグイン](http://homepage2.nifty.com/MJHS/)
(c) イノビア

> 利用するソフトに添付するなりご自由にどうぞ。
> Readmeに書いてくれるとちょっと嬉しい。

### [HSP開発wiki:二つの画像を比較し総似率を返す](http://wiki.hsp.moe/As.html)

### [error.wav:ニコニ・コモンズ「警告音」](http://commons.nicovideo.jp/material/nc10263)
(c) あきOh!

### [motor_loop.wav/motor_stop.wav:ニコニ・コモンズ「機械風の音」](http://commons.nicovideo.jp/material/nc30633)
(c) kenek_0317

### [voiceデータ:CeVIO Creative Studio FREE](http://cevio.jp/)

### [ffmpeg.exe:動画・音声変換ソフト](http://www.ffmpeg.org/)

## LICENSE

(c) 3846masa MIT
